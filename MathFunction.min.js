(function(ca,Y,H,p,Z,x){var h=function(){};h.prototype={left:!1,right:!1,hasRight:function(){return!1!==this.right},hasLeft:function(){return!1!==this.left},setLeaves:function(a,b){this.left=a;this.right=b},hasLeaves:function(){return this.left&&this.right},evaluate:function(){return!1},getParameters:function(){var a=[];this.addParametersFromChild(a,this.left);this.addParametersFromChild(a,this.right);return a},addParametersFromChild:function(a,b){b&&b.getParameters().forEach(function(b){-1<a.indexOf(b)||
a.push(b)})},plot:function(a,b,c,d,f){var g=[],e=[],j=[a];f=f||[];for(f.forEach(function(a){j.push(a.label);e.push(a.value)});b<=c;b+=d)a=this.evaluate(j,[b].concat(e)),g.push([b,a]);return g},replace:function(a,b){var c=this.left,d=this.right;c&&(c instanceof k&&c.label===a)&&(this.left=b);d&&(d instanceof k&&d.label===a)&&(this.right=b)}};var l=function(a){this.value=parseFloat(a)};l.prototype=new h;l.prototype.nf=function(a){var b=(""+a).length-1-(""+(a|0)).length;0>b&&(b=0);return a.toFixed(b)};
l.prototype.evaluate=function(){return this.value};l.prototype.toString=function(){return this.nf(this.value)};l.prototype.toLaTeX=function(){return"{"+this.nf(this.value)+"}"};l.prototype.getParameters=function(){return[]};l.prototype.derive=function(){return this};var k=function(a){this.label=a};k.prototype=new h;k.prototype.evaluate=function(){return 1==arguments.length?this.evaluate$1(arguments[0]):2==arguments.length?this.evaluate$2(arguments[0],arguments[1]):!1};k.prototype.evaluate$1=function(a){return a};
k.prototype.evaluate$2=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]==this.label)return b[c];return!1};k.prototype.getParameters=function(){return[this.label]};k.prototype.toString=function(){return this.label};k.prototype.toLaTeX=function(){return this.label};var e=function(a,b){this.label=a;this.value=b};e.prototype=new l;var I=function(){};I.prototype=new e("\u03c0",Math.PI);I.prototype.toLaTeX=function(){return"\u03c0"};var J=function(){};J.prototype=new e("e",Math.E);J.prototype.toLaTeX=
function(){return"e"};var $=function(a){return"\u03c0"==a||"pi"==a?new I:"e"==a?new J:a==parseFloat(a)?new l(a):new k(a)},e=function(a,b){this.operator=a;this.strength=b};e.prototype=new h;e.prototype.getStrength=function(){return this.strength};e.prototype.toString=function(){var a=this.left,b=this.right;return(a?a.toString():"")+this.operator+(b?b.toString():"")};e.prototype.toLaTeX=function(){return this.left.toLaTeX()+this.operator+this.right.toLaTeX()};var K=function(){};K.prototype=new e("+",
1);K.prototype.evaluate=function(a,b){var c=this.right;return this.left.evaluate(a,b)+c.evaluate(a,b)};var L=function(){};L.prototype=new e("-",1);L.prototype.evaluate=function(a,b){var c=this.right;return this.left.evaluate(a,b)-c.evaluate(a,b)};var y=function(){};y.prototype=new e("*",2);y.prototype.evaluate=function(a,b){var c=this.right;return this.left.evaluate(a,b)*c.evaluate(a,b)};y.prototype.toLaTeX=function(){return this.left.toLaTeX()+" \\cdot "+this.right.toLaTeX()};var z=function(){};
z.prototype=new e("/",2);z.prototype.evaluate=function(a,b){var c=this.right;return this.left.evaluate(a,b)/c.evaluate(a,b)};z.prototype.toLaTeX=function(){return"\\frac{"+this.left.toLaTeX()+"}{"+this.right.toLaTeX()+"}"};var q=function(){};q.prototype=new e("-",3);q.prototype.hasLeft=function(){return!1};q.prototype.hasLeaves=function(){return!1!==this.right};q.prototype.setLeaves=function(a,b){this.right=b};q.prototype.evaluate=function(a,b){return-this.right.evaluate(a,b)};q.prototype.toLaTeX=
function(){return"-"+this.right.toLaTeX()};var M=function(){};M.prototype=new e("^",4);M.prototype.evaluate=function(a,b){var c=this.right;return Math.pow(this.left.evaluate(a,b),c.evaluate(a,b))};var n=function(){};n.prototype=new e("!",5);n.prototype.hasLeft=function(){return!1};n.prototype.hasLeaves=function(){return!1!==this.left};n.prototype.setLeaves=function(a){this.left=a};n.prototype.factorial=function(a){return 1>=a?1:a*this.factorial(a-1)};n.prototype.evaluate=function(a,b){var c=this.left.evaluate(a,
b)|0;return this.factorial(c)};n.prototype.toLaTeX=function(){return this.left.toLaTeX()+"!"};e=function(a){this.label=a};e.prototype=new h;e.prototype.setContent=function(a){this.setLeaves(!1,a);this.content=a};e.prototype.replace=function(a,b){if(this.content instanceof k&&this.content.label===a){var c=new m(b.toString());this.setContent(c.functionTree)}else this.content.replace(a,b)};e.prototype.toString=function(){return this.label+"("+this.content.toString()+")"};e.prototype.toLaTeX=function(){return this.label+
"\\left ( "+this.content.toLaTeX()+" \\right ) "};var u=function(a){this.setContent(a)};u.prototype=new e("wrapper");u.prototype.toString=function(){return"("+this.content.toString()+")"};u.prototype.toLaTeX=function(){return" \\left ( "+this.content.toLaTeX()+" \\right ) "};u.prototype.evaluate=function(a,b){return this.content.evaluate(a,b)};var N=function(a){this.setContent(a)};N.prototype=new e("sin");N.prototype.evaluate=function(a,b){return Math.sin(this.content.evaluate(a,b))};var O=function(a){this.setContent(a)};
O.prototype=new e("cos");O.prototype.evaluate=function(a,b){return Math.cos(this.content.evaluate(a,b))};var P=function(a){this.setContent(a)};P.prototype=new e("tan");P.prototype.evaluate=function(a,b){return Math.tan(this.content.evaluate(a,b))};var Q=function(a){this.setContent(a)};Q.prototype=new e("asin");Q.prototype.evaluate=function(a,b){return Math.asin(this.content.evaluate(a,b))};var R=function(a){this.setContent(a)};R.prototype=new e("acos");R.prototype.evaluate=function(a,b){return Math.acos(this.content.evaluate(a,
b))};var S=function(a){this.setContent(a)};S.prototype=new e("atan");S.prototype.evaluate=function(a,b){return Math.atan(this.content.evaluate(a,b))};var T=function(a){this.setContent(a)};T.prototype=new e("sinh");T.prototype.evaluate=function(a,b){return Math.sinh(this.content.evaluate(a,b))};var U=function(a){this.setContent(a)};U.prototype=new e("cosh");U.prototype.evaluate=function(a,b){return Math.cosh(this.content.evaluate(a,b))};var V=function(a){this.setContent(a)};V.prototype=new e("tanh");
V.prototype.evaluate=function(a,b){return Math.tanh(this.content.evaluate(a,b))};var W=function(a){this.setContent(a)};W.prototype=new e("ln");W.prototype.evaluate=function(a,b){var c=this.content.evaluate(a,b);return Math.log(c)/Math.log(Math.E)};var X=function(a){this.setContent(a)};X.prototype=new e("log");X.prototype.evaluate=function(a,b){var c=this.content.evaluate(a,b);return Math.log(c)/Math.log(10)};var A=function(a){this.setContent(a)};A.prototype=new e("sqrt");A.prototype.evaluate=function(a,
b){return Math.sqrt(this.content.evaluate(a,b))};A.prototype.toLaTeX=function(){return"\\sqrt{"+this.content.toLaTeX()+"}"};var B=function(a){this.setContent(a)};B.prototype=new e("abs");B.prototype.evaluate=function(a,b){return Math.abs(this.content.evaluate(a,b))};B.prototype.toLaTeX=function(){return"|"+this.content.toLaTeX()+"|"};h=function(a){this.label=a};h.prototype=new e;h.prototype.getParameters=function(){return this.content.getParameters()};h.prototype.bindAll=function(a,b,c){this.startValue=
c;this.setContent(b);params=[];a.forEach(function(a){params.push($(a))});this.parameters=params};h.prototype.evaluate=function(a,b){var c;c=a.indexOf("n");-1===c&&(c=a.length,a.push("n"));var d=this.parameters[0].evaluate(a,b),f=this.parameters[1].evaluate(a,b);return this.computeAggregate(d,f,c,a,b)};var C=function(a,b){this.bindAll(a,b,0)};C.prototype=new h("sum");C.prototype.computeAggregate=function(a,b,c,d,f){var g=this.startValue;a=Math.round(a)|0;for(b=Math.round(b)|0;a<=b;a++)f[c]=a,g+=this.content.evaluate(d,
f);return g};C.prototype.toLaTeX=function(){var a=this.parameters;return"\\sum_{n="+a[0].toLaTeX()+"}^{"+a[1].toLaTeX()+"} "+this.content.toLaTeX()};var D=function(a,b){this.bindAll(a,b,1)};D.prototype=new h("prod");D.prototype.computeAggregate=function(a,b,c,d,f){var g=this.startValue;a=Math.round(a)|0;for(b=Math.round(b)|0;a<=b;a++)f[c]=a,g*=this.content.evaluate(d,f);return g};D.prototype.toLaTeX=function(){var a=this.parameters;return"\\prod_{n="+a[0].toLaTeX()+"}^{"+a[1].toLaTeX()+"} "+this.content.toLaTeX()};
var E=function(a,b){this.bindAll(a,b,0)};E.prototype=new h("area");E.prototype.computeAggregate=function(a,b,c,d,f){c=this.parameters;var g=c[2].evaluate(),g=(b-a)/g,e=c[3].getParameters()[0],j=this.startValue;for(c=0;c<d.length&&d[c]!=e;c++);for(e=a+g/2;e<b;e+=g)f[c]=e,a=this.content.evaluate(d,f),j+=g*Math.abs(a);return j};E.prototype.toLaTeX=function(){var a=this.parameters;return"\\int_{"+a[0].toLaTeX()+"}^{"+a[1].toLaTeX()+"} "+this.content.toLaTeX()+" d"+a[3].label};var aa=function(a,b){b&&
(a=a.replace(/[ \t\n\s]/g,""));this.data=a.split("");this.length=a.length;this.position=0};aa.prototype={read:function(){return this.data[this.position]},more:function(){return this.position<this.length},advance:function(){this.position<this.length-1&&this.position++},next:function(){return this.data[this.position++]},peek:function(){return this.data[this.position+1]},skipGroup:function(a,b){for(var c="",d;this.position<this.length;)if(d=this.data[this.position++],d==a)c+=this.skipGroup(a,b);else if(d==
b)break;else c+=d;return a+c+b},toString:function(){var a=join(this.data,"");return a=a.substring(0,this.position)+" "+this.data[this.position]+" "+a.substring(this.position+1)}};var r=function(a){this.setup(a)};r.afCount=1;r.prototype={setup:function(a){this.uid=r.afCount++;this.sumarguments=[];this.fragment=a;this.children=[];this.functor="";this.expanded=this.wrapped=!1},getBalance:function(){var a=this.fragment.split(""),b=0,c,d;c=0;for(d=a.length;c<d;c++)"("==a[c]&&b++,")"==a[c]&&b--;return b},
isFunctionWrapped:function(a){if(!a.match(/^\w+\(.+\)/))return!1;a=a.replace(/^\w+/g,"");return this.isParensWrapped(a)},isParensWrapped:function(a){if(!a.match(/^\(.*\)$/))return!1;a=a.split("");var b=0,c,d;d=0;for(c=a.length;d<c;d++)if(""!==a[d]&&("("===a[d]&&b++,")"===a[d]&&b--,0===b&&d<c-1))return!1;return 0===b},isArithmeticOperator:function(a){return"+"==a||"-"==a||"*"==a||"/"==a||"^"==a||"!"==a},expand:function(){if(!this.expanded){var a=!1,b=!1;this.isFunctionWrapped(this.fragment)&&(b=!0,
this.functor=this.fragment.substring(0,this.fragment.indexOf("(")),this.fragment=this.fragment.replace(RegExp("^"+this.functor),""));this.isParensWrapped(this.fragment)&&(b||(this.wrapped=!0),b=!0,this.fragment=this.fragment.substring(1,this.fragment.length-1));if(("sum"==this.functor||"prod"==this.functor||"area"==this.functor)&&""!==this.fragment.trim()){var c=this.fragment.indexOf(","),d=this.fragment.indexOf("(");-1===d&&(d=this.fragment.length());for(var f="";-1<c&&c<d;)f=this.fragment.substring(0,
c),this.fragment=this.fragment.replace(RegExp("^"+f+",","g"),""),d--,this.sumarguments.push(f),c=this.fragment.indexOf(",")}for(var c=new aa(this.fragment,!0),d="",g=!1;c.more();)f=c.next(),this.isArithmeticOperator(f)?(a=!0,""!==d.trim()||g?(""!==d.trim()&&(this.fragment="",this.children.push(new r(d))),"!"==f?this.children.push(new F(f)):this.children.push(new v(f)),d=""):"-"===f&&this.children.push(new F("-")),g=!0):"("===f?d+=c.skipGroup("(",")"):(g=!1,d+=f);if((a||b)&&""!==d)this.children.push(new r(d)),
a=!0;a&&this.children.forEach(function(a){a.expand()});this.expanded=!0}},formFunctionTree:function(){var a;a=[];this.expanded||this.expand();if(0<this.children.length){var b,c=this.children.length;for(b=0;b<c;b++){var d=this.children[b];d instanceof F?a.push("-"==d.operator?new q:"!"==d.operator?new n:!1):d instanceof v?a.push("+"==d.operator?new K:"-"==d.operator?new L:"*"==d.operator?new y:"/"==d.operator?new z:"^"==d.operator?new M:!1):a.push(d.formFunctionTree())}for(var f=d=!1,g,c=6;0<=c;c--)for(b=
a.length-1;0<=b;b--)g=a[b],g.getStrength&&(g.getStrength()==c&&!g.hasLeaves())&&(d=(d=g.hasRight())?!1:a.splice(b+1,1)[0],f=(f=g.hasLeft())?!1:a.splice(b-1,1)[0],g.setLeaves(f,d));a=0<a.length?a[0]:g}else a=$(this.fragment);this.functor&&(b=this.functor,g=this.sumarguments,c=a,b="sum"==b?new C(g,c):"prod"==b?new D(g,c):"area"==b?new E(g,c):!1,a=b?b:"sin"==this.functor?new N(a):"cos"==this.functor?new O(a):"tan"==this.functor?new P(a):"asin"==this.functor?new Q(a):"acos"==this.functor?new R(a):"atan"==
this.functor?new S(a):"sinh"==this.functor?new T(a):"cosh"==this.functor?new U(a):"tanh"==this.functor?new V(a):"ln"==this.functor?new W(a):"log"==this.functor?new X(a):"sqrt"==this.functor?new A(a):"abs"==this.functor?new B(a):!1);this.wrapped&&(a=new u(a));return a},toString:function(a){if(!a)return this.toString(" ");var b="["+this.uid+"] ",b=this.functor?this.functor+"[":"";if(0<this.children.length){for(var c=[],d=0,f=this.children.length;d<f;d++)c[d]=this.children[d].toString(a+" ");b+=c.join("")}else b+=
this.fragment;return"{"+b+(this.functor?"]":"")+"}"}};var v=function(a){this.setup("");this.operator=a};v.prototype=new r("");v.prototype.toString=function(){return""+this.operator};var F=function(a){this.setup("");this.operator=a};F.prototype=new v("");p||H&&H.warn&&H.warn("MathJax is not available, math functions will not be able to render LaTeX.");var ba,s=!1,t=!1,w=!1;ba=function(a,b){if(!1===s&&!1===t)return s=a,t=b,!1;if(!1===w)return w=(b-t)/(a-s),s=a,t=b,!1;var c=(b-t)/(a-s),d=4<c&&-4>w||
-4>c&&4<w;s=a;t=b;w=c;return d};var G=function(a,b){return function(c,d,f,g){if(Z(c))return!1;if(Infinity==c)return x(2,31);if(-Infinity==c)return-x(2,31);g=a+(b-a)*((c-d)/(f-d));return Z(g)?!1:Infinity==g?x(2,31):-Infinity==g?-x(2,31):g}},m=function(a){this.plotCanvas=!1;this.LaTeX=this.functionString="";this.functionTree=this.arithmeticFragment=!1;this.init(a)};m.prototype={init:function(a){this.functionString=a.replace(/\s/g,"");this.arithmeticFragment=new r(this.functionString);a=this.arithmeticFragment.getBalance();
if(0===a)this.functionTree=this.arithmeticFragment.formFunctionTree(),this.LaTeX=this.functionTree.toLaTeX();else throw"Function is unbalanced: "+this.arithmeticFragment.toString()+" has "+a+" open groups";},getParameters:function(){return this.functionTree.getParameters()},render:function(a){p?(a.innerHTML="\\["+this.LaTeX+"\\]",p.Hub.Queue(["Typeset",p.Hub,a])):a.innerHTML=this.functionTree.toString()},plot:function(a,b,c){this.options=b;c=c||{minx:0,maxx:a.clientWidth,miny:0,maxy:a.clientHeight};
if(this.plotCanvas)a=this.plotCanvas.getContext("2d");else{var d=Y.createElement("canvas");d.width=b.width||400;this.mapx=G(0,d.width);d.height=b.height||400;this.mapy=G(d.height,0);d.style.border="1px solid black";a.innerHTML="";a.appendChild(d);this.plotCanvas=d;a=this.plotCanvas.getContext("2d");this.clear(a)}d=b.variable;b=this.functionTree.plot(d.label,d.start,d.end,d.step,b.clamped);d=c;d={minx:d.minx,maxx:d.maxx,miny:d.miny,maxy:d.maxy,asymptotes:[]};this.drawAxes(a,c.axes,d);this.drawPlotData(a,
b,d)},drawAxes:function(a,b,c){b=b||{x:0,y:0};var d;d=this.mapx(b.x,c.minx,c.maxx);a.strokeStyle="#999";a.moveTo(d,0);a.lineTo(d,400);a.stroke();a.beginPath();d=this.mapy(b.y,c.miny,c.maxy);a.moveTo(0,d);a.lineTo(400,d);a.stroke();a.beginPath()},drawPlotData:function(a,b,c){a=a||this.plotCanvas.getContext("2d");var d=c.asymptotes;a.strokeStyle="black";var f,g=b.length,e,j,h;for(f=0;f<g;f++)e=b[f][0],j=this.mapx(e,c.minx,c.maxx),h=this.mapy(b[f][1],c.miny,c.maxy),(asym=ba(j,h))?(d.push(e),a.stroke(),
a.beginPath(),first=!0):a.lineTo(j,h);a.stroke();this.drawAsymptotes(a,c)},drawAsymptotes:function(a,b){var c=this;this.functionTree.x||(a.strokeStyle="rgba(255,0,0,0.5)",b.asymptotes.forEach(function(d){d=c.mapx(d,b.minx,b.maxx);a.beginPath();a.moveTo(d,0);a.lineTo(d,400);a.stroke()}))},clear:function(){this.plotCanvas&&(this.plotCanvas.width=this.options.width,this.plotCanvas.height=this.options.height)},replace:function(a,b){"string"===typeof b&&(b=new m(b));this.functionTree.replace(a,b.functionTree);
b=new m(this.functionTree.toString());this.functionString=b.functionString;this.LaTeX=b.LaTeX;this.arithmeticFragment=b.arithmeticFragment;this.functionTree=b.functionTree},toString:function(){return this.functionString},toLaTeX:function(){return this.LaTeX}};m.Compound=function(a){var b=[],c=function(a){b.push(new m(a))};a instanceof Array?a.forEach(c):Array.prototype.forEach.call(arguments,c);this.functions=b};m.Compound.prototype={getParameters:function(){var a=[];this.functions.forEach(function(b){b.functionTree.getParameters().forEach(function(b){-1===
a.indexOf(b)&&a.push(b)})});return a},render:function(a){var b="\\[\\left \\{ \\begin{array}{l}\n",c=[],d=1;this.functions.forEach(function(a){c.push("f_"+d++ +" = "+a.LaTeX)});b+=c.join("\\\\\n")+"\n\\end{array} \\right . \\]";a.innerHTML=b;p&&p.Hub.Queue(["Typeset",p.Hub,a])},plot:function(a,b,c){this.options=b;c=c||{minx:0,maxx:a.clientWidth,miny:0,maxy:a.clientHeight};if(this.plotCanvas)a=this.plotCanvas.getContext("2d");else{var d=Y.createElement("canvas");d.width=b.width||400;this.mapx=G(0,
d.width);d.height=b.height||400;this.mapy=G(d.height,0);d.style.border="1px solid black";a.innerHTML="";a.appendChild(d);this.plotCanvas=d;a=this.plotCanvas.getContext("2d");this.clear(a);this.functions.forEach(function(a){a.plotCanvas=d})}var f=b.variable,e=[],h=[],j=c;this.functions.forEach(function(a){e.push(a.functionTree.plot(f.label,f.start,f.end,f.step,b.clamped));h.push({minx:j.minx,maxx:j.maxx,miny:j.miny,maxy:j.maxy,asymptotes:[]})});this.drawAxes(a,c.order,c.axes,h);this.drawPlotData(a,
c.order,e,h)},drawAxes:function(a,b,c,d){b=b||[0,1];c=c||{x:0,y:0};var f=b[0];b=b[1];f=this.mapx(c.x,d[f].minx,d[f].maxx);a.strokeStyle="#999";a.moveTo(f,0);a.lineTo(f,400);a.stroke();a.beginPath();f=this.mapy(c.y,d[b].miny,d[b].maxy);a.moveTo(0,f);a.lineTo(400,f);a.stroke();a.beginPath()},drawPlotData:function(a,b,c,d){b=b||[0,1];a=a||this.plotCanvas.getContext("2d");a.strokeStyle="black";var f=c[0].length,e,h,j=b[0],k=b[1];for(b=0;b<f;b++)e=c[j][b][1],h=c[k][b][1],e=this.mapx(e,d[j].minx,d[j].maxx),
h=this.mapy(h,d[k].miny,d[k].maxy),a.lineTo(e,h);a.stroke()},clear:function(a){m.prototype.clear.call(this,a)},toString:function(){var a=[];this.functions.forEach(function(b){a.push(b.toString())});return a.join(", ")},toLaTeX:function(){var a=[];this.functions.forEach(function(b){a.push(b.toLaTeX())});return a}};ca.MathFunction=m})(window,document,window.console,MathJax,isNaN,Math.pow);
