<!doctype html>
<html style="height: 100%;" class="no-js">
  <head>
    <meta charset="utf-8">
    <title>A Math Parser for Processing, written in Processing, running with Processing.js</title>
    <!-- styles -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/slider.css">
    <!-- shims -->
<!--
    <script src="js/shim/modernizr.js"></script>
    <script>Modernizr.load([{test: Modernizr.inputtypes.range, nope: ['js/shim/html5slider.js']}]);</script>
-->
    <!-- resource scripts -->
    <script src="js/resource/toolkit.js"></script>
    <script src="js/resource/processing-1.4.1-patched.js"></script>
    <script src="js/resource/jquery/jquery.js"></script>
    <script src="js/resource/jquery/jquery-ui.js"></script>
    <!-- content scripts -->
    <script src="js/Double.js"></script>
    <script src="js/bindsketch.js"></script>
    <script src="js/mathparser.js"></script>
    <script>
      MathParser.onAddVariable = function(variable, htmlElement) {
        var label = variable.label,
            update = function(event, ui) {
              // This is ridiculous, but necessary: compute slider value manually
              var head = ui.handle,
                  base = head.parentNode,
                  l = $(base).offset().left,
                  o = $(head).offset().left - l + $(head).width()/2,
                  w = $(base).width(),
                  hval = o/w,
                  min = parseFloat(base.getAttribute("min")),
                  max = parseFloat(base.getAttribute("max")),
                  step = parseFloat(base.getAttribute("step")),
                  iv = 1 / step,
                  value = Math.round(iv*(min + hval * (max - min)))*step;
              // even more ridiculousness
              base.setAttribute("value",value);
              find("#current_"+label).html(Math.round(1000*value)/1000);
              MathParser.updateVariable(label, this, value);
            };
        $("#range_"+label).slider({change: update, start: update, slide: update, stop: update}).attr("id","range_"+label);
      };
    </script>
  </head>
  
  <body style="vertical-align: top; height: 90%;">
    <a href="https://github.com/pomax/mathparser">
      <img style="position: absolute; float: right; top: 0; right: 0; border: 0; opacity: 0.7;"
           src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
           alt="Fork me on GitHub"></a>
  
  
    <h2 id="body">A math function parser for Processing, written in Processing, running with Processing.js</h2>

    <div style="float:left;">
      <div>
        Type a function<span id="paramlabel_x"></span>:
        <input type="text" placeholder="1/t" id="function_x" onkeyup="MathParser.updateFunction(this)"><br>

        parametric function: <input type="checkbox" id="parametric" onchange="MathParser.checkbox(this)"><br>

        <div id="params" style="display: none">
          Type a function<span id="paramlabel_y"> for y</span>:
          <input type="text" placeholder="cos(t) - sin(t)^2 + sin(t)" id="function_y" onkeyup="MathParser.updateFunction(this)">
        </div>

        <div id="parameters">
          <p>Variables <span class='minor'>(<i>t</i> always acts as control variable)</span>:</p>
          <div id="variables"></div>
        </div>
      </div>
      
      <div>
        <canvas id="plot"
                style="clear: both; border: 1px solid black;"
                data-processing-sources="mathparser/ArithmeticFragment.pde
                                         mathparser/FunctionTree.pde
                                         mathparser/Tape.pde
                                         mathparser/Variables.pde
                                         mathparser/utilities.pde
                                         mathparser/parseFunctions.pde
                                         mathparser/mathparser.pde
                                         mathparser/JavaScript.pde
                                         RuntimeException.patch"></canvas>
        <p>And of course, a <a href="" id="link">link</a> to show people this graph!</p>
      </div>
    </div>

    <div style="float: right; width: 500px; height: 90%; overflow-y: scroll; padding-right: 2em;">
      <p>The API (<i>a.k.a. "what can I use"</i>):</p>
      
      <p><strong>unary operators</strong></p>

      <dl>
        <dt>-n</dt><dd>negative n</dd>
        <dt>n!</dt><dd>factorial of n</dd>
      </dl>     

      <p><strong>binary operators</strong></p>

      <dl>
        <dt>n+m</dt><dd>m added to n</dd>
        <dt>n-m</dt><dd>m subtracted from n</dd>
        <dt>n*m</dt><dd>n multiplied by m</dd>
        <dt>n/m</dt><dd>n divided by m</dd>
        <dt>n^m</dt><dd>n raised to the power m</dd>
        <dt>(…)</dt><dd>explicit grouping</dd>
      </dl>
      
      <p><strong>operator order</strong></p>
      
      <dl>
        <dt>1</dt><dd>barring explicit groups, ! is evaluated first,</dd>
        <dt>2</dt><dd>then ^ is evaluated,</dd>
        <dt>3</dt><dd>then the negating - is evaluated,</dd>
        <dt>4</dt><dd>then * and / are evaluated, </dd>
        <dt>5</dt><dd>and then, finally, + and - are evaluated.</dd>
      </dl>
      
      <p>In a statement like "t^2 - t + 10", equal order operators
      are resolved left to right, so this is equivalent to "(t^2 - t) + 10".</p>

      <p><strong>constants</strong></p>
      
      <dl>
        <dt>e</dt><dd>the natural logarithm base</dd>
        <dt>pi</dt><dd>the circumference of a circle with diameter 0.5</dd>
      </dl>
      
      <p><strong>functions</strong></p>
      
      <dl>
        <dt>sin(x)</dt><dd>the sine function</dd>
        <dt>cos(x)</dt><dd>the cosine function</dd>
        <dt>tan(x)</dt><dd>the tangent function</dd>
        <dt>asin(x)</dt><dd>the arcsine function</dd>
        <dt>acos(x)</dt><dd>the arccosine function</dd>
        <dt>atan(x)</dt><dd>the arctangent function</dd>
        <dt>sinh(x)</dt><dd>the hyperbolic sine function</dd>
        <dt>cosh(x)</dt><dd>the hyperbolic cosine function</dd>
        <dt>tanh(x)</dt><dd>the hyperbolic tangent function</dd>
        <dt>ln(x)</dt><dd>the natural logarithm function (using base <i>e</i>)</dd>
        <dt>log(x)</dt><dd>the decimal logarithm function (using base 10)</dd>
        <dt>sqrt(x)</dt><dd>the square root function</dd>
        <dt>abs(x)</dt><dd>the absolute value function</dd>
      </dl>
      
      <p>There is no <code>exp</code> function - just use <i>e</i><code>^</code><i>x</i>.
      There are also no other exponent function beyond <code>sqrt</code>,
      which is just something that effects <i>x</i><code>^</code>0.5 — simply
      use the <code>^</code> operator for anything involving roots and powers.</p>

      <p>Also, if you need a different base logarithmic function,
      use log division: base 2 is log(x)/log(2), base pi is log(x)/log(pi),
      etc.</p>
    </div>

  </body>
  <script>
    // If the slider file has loaded then fire the onDomReady event        
    if("fdSlider" in window && typeof (fdSlider.onDomReady) != "undefined") {
      try { fdSlider.onDomReady(); } catch(err) {};
    }
  </script>
</html>